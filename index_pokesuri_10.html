<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ポケスリ全部いえるかな？</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{ --blue-light:#5aa9ff; --red-light:#ff7f7f; --text-white:#ffffff; --disabled-bg:#e0e0e0; --disabled-text:#9e9e9e; --card-bg:#ffffff; --panel-bg:rgba(255,255,255,.70); }
    html,body{height:100%;}
    body{ margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic UI","Meiryo",Arial,sans-serif; color:#111; text-align:left;
      background-image:url("./greenglass.jpg"); background-size:cover; background-position:center; background-repeat:no-repeat; background-color:#8fdc6b; }
    h1{ text-align:center; margin:18px 0 10px; }
    .input-row{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; margin:0 auto; width:min(1100px,92vw);}
    .hint{ font-size:.9em; color:#333; }
    input{ font-size:16px; padding:8px 10px; border-radius:6px; border:1px solid #cfd8dc; background:#fff; }
    button{ font-size:16px; padding:8px 14px; cursor:pointer; border:none; border-radius:6px; }
    .btn-answer{ background:var(--blue-light); color:var(--text-white);}
    .btn-start{  background:var(--red-light);  color:var(--text-white);}
    .btn-share{  background:var(--blue-light); color:var(--text-white);}
    button:disabled, input:disabled{ background:var(--disabled-bg)!important; color:var(--disabled-text)!important; cursor:not-allowed; }

    .status-row{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; margin:8px auto 0; width:min(1100px,92vw);}
    .status-left{ display:flex; align-items:center; gap:12px; flex-wrap:wrap;}
    .status-right{ margin-left:auto;}

    #scrollContainer{ max-height:520px; overflow:auto; border:1px solid #cfd8dc; margin:18px auto; width:min(1100px,92vw); background:var(--panel-bg); border-radius:10px; padding:14px; box-shadow:0 6px 16px rgba(0,0,0,.08);}
    .grid{ display:grid; grid-template-columns:repeat(auto-fill, minmax(120px,1fr)); grid-auto-rows:minmax(24px,auto); grid-auto-flow:row; gap:6px;}
    .grid .cell{ background:var(--card-bg); border:1px solid #e3e7ea; border-radius:6px; padding:4px 6px; font-size:13px; font-weight:600; line-height:1.2; box-shadow:0 1px 4px rgba(0,0,0,.05); min-height:1.8em;}

    .footer{ width:min(1100px,92vw); margin:10px auto 18px; font-size:12px; color:#333; text-align:right; line-height:1.6;}
    .footer a{ color:#0b69ff; text-decoration:none; } .footer a:hover{ text-decoration:underline; }

    .modal-overlay{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.5); align-items:center; justify-content:center; z-index:9999;}
    .modal{ background:#fff; padding:20px; border-radius:10px; width:min(520px,92vw); box-shadow:0 12px 30px rgba(0,0,0,.25);}
    .modal h2{ margin:.2em 0 .6em; text-align:left;} .modal .actions{ display:flex; justify-content:flex-end; gap:8px; margin-top:14px;}
  </style>
</head>
<body>
  <h1>ポケスリ全部いえるかな？</h1>

  <div class="input-row">
    <p class="hint">ポケモンの名前を入力してください（ひらがなOK）</p>
    <strong id="progressText">0／0</strong>
  </div>

  <div class="status-row">
    <div class="status-left">
      <input type="text" id="pokemonInput" placeholder="ポケモンの名前を入力" disabled />
      <button id="answerBtn" class="btn-answer" disabled>回答</button>
      <button id="startBtn" class="btn-start">開始</button>
      <span id="timer">00:00:00</span>
    </div>
    <div class="status-right">
      <button id="shareBtnMain" class="btn-share">結果をXで共有</button>
    </div>
  </div>

  <div id="scrollContainer">
    <div class="grid" id="pokemonList"></div>
  </div>

  <div class="footer">
    <div>Ver. 2.12.2</div>
    <div>X：羊谷ランプ@fuck_capslock（<a href="https://x.com/fuck_capslock" target="_blank" rel="noopener noreferrer">https://x.com/fuck_capslock</a>）</div>
    <div>Inspired by ポケモン全部言えるかな？ゲーム</div>
  </div>

  <div id="completeOverlay" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="completeTitle">
    <div class="modal">
      <h2 id="completeTitle">全問正解！あなたは立派な廃人プレイヤーです！！</h2>
      <div class="actions">
        <button id="completeShareBtn" class="btn-share">結果をXで共有</button>
        <button id="completeOk" class="btn-start">OK</button>
      </div>
    </div>
  </div>

  <script>
    // 文字正規化：NFKC → 括弧を全角に → ひらがな→カタカナ
    function canon(str){
      if(!str) return "";
      let s = str.trim().normalize('NFKC');
      s = s.replace(/[()]/g, m => m === '(' ? '（' : '）');
      s = s.replace(/[\\u3041-\\u3096]/g, ch => String.fromCharCode(ch.charCodeAt(0)+0x60));
      return s;
    }

    const pokemonTableRaw = [
  "フシギダネ", "フシギソウ", "フシギバナ", "ヒトカゲ", "リザード",
  "リザードン", "ゼニガメ", "カメール", "カメックス", "キャタピー",
  "トランセル", "バタフリー", "コラッタ", "ラッタ", "アーボ",
  "アーボック", "ピカチュウ", "ピカチュウ（ハロウィン）", "ライチュウ", "ピッピ",
  "ピクシー", "ロコン", "キュウコン", "プリン", "プクリン",
  "ディグダ", "ダグトリオ", "ニャース", "ペルシアン", "コダック",
  "ゴルダック", "マンキー", "オコリザル", "ガーディ", "ウインディ",
  "マダツボミ", "ウツドン", "ウツボット", "イシツブテ", "ゴローン",
  "ゴローニャ", "ヤドン", "ヤドラン", "コイル", "レアコイル",
  "カモネギ", "ドードー", "ドードリオ", "ゴース", "ゴースト",
  "ゲンガー", "イワーク", "カラカラ", "ガラガラ", "ラッキー",
  "ガルーラ", "バリヤード", "カイロス", "メタモン", "イーブイ",
  "シャワーズ", "サンダース", "ブースター", "ミニリュウ", "ハクリュー",
  "カイリュー", "チコリータ", "ベイリーフ", "メガニウム", "ヒノアラシ",
  "マグマラシ", "バクフーン", "ワニノコ", "アリゲイツ", "オーダイル",
  "ピチュー", "ピィ", "ププリン", "トゲピー", "トゲチック",
  "ネイティ", "ネイティオ", "メリープ", "モココ", "デンリュウ",
  "ウソッキー", "ウパー", "ヌオー", "エーフィ", "ブラッキー",
  "ヤミカラス", "ヤドキング", "ソーナンス", "ハガネール", "ヘラクロス",
  "ニューラ", "デリバード", "デルビル", "ヘルガー", "ハピナス",
  "ライコウ", "エンテイ", "スイクン", "ヨーギラス", "サナギラス",
  "バンギラス", "キモリ", "ジュプトル", "ジュカイン", "アチャモ",
  "ワカシャモ", "バシャーモ", "ミズゴロウ", "ヌマクロー", "ラグラージ",
  "ラルトス", "キルリア", "サーナイト", "ナマケロ", "ヤルキモノ",
  "ケッキング", "ヤミラミ", "クチート", "ココドラ", "コドラ",
  "ボスゴドラ", "プラスル", "マイナン", "ゴクリン", "マルノーム",
  "チルット", "チルタリス", "カゲボウズ", "ジュペッタ", "アブソル",
  "ソーナノ", "タマザラシ", "トドグラー", "トドゼルガ", "コリンク",
  "ルクシオ", "レントラー", "フワンテ", "フワライド", "ドンカラス",
  "ウソハチ", "マネネ", "ピンプク", "リオル", "ルカリオ",
  "グレッグル", "ドクロッグ", "ユキカブリ", "ユキノオー", "マニューラ",
  "ジバコイル", "トゲキッス", "リーフィア", "グレイシア", "エルレイド",
  "クレセリア", "ダークライ", "ムンナ", "ムシャーナ", "ワシボン",
  "ウォーグル", "ニンフィア", "デデンネ", "アゴジムシ", "デンヂムシ",
  "クワガノン", "ヌイコグマ", "キテルグマ", "キュワワー", "ミミッキュ",
  "ウッウ", "エレズン", "ストリンダー", "ニャオハ", "ニャローテ",
  "マスカーニャ", "ホゲータ", "アチゲータ", "ラウドボーン", "クワッス",
  "ウェルカモ", "ウェーニバル", "パモ", "パモット", "パーモット",
  "ドオー"
];
    const pokemonNumbers  = [
  "0001", "0002", "0003", "0004", "0005",
  "0006", "0007", "0008", "0009", "0010",
  "0011", "0012", "0019", "0020", "0023",
  "0024", "0025", "0025", "0026", "0035",
  "0036", "0037", "0038", "0039", "0040",
  "0050", "0051", "0052", "0053", "0054",
  "0055", "0056", "0057", "0058", "0059",
  "0069", "0070", "0071", "0074", "0075",
  "0076", "0079", "0080", "0081", "0082",
  "0083", "0084", "0085", "0092", "0093",
  "0094", "0095", "0104", "0105", "0113",
  "0115", "0122", "0127", "0132", "0133",
  "0134", "0135", "0136", "0147", "0148",
  "0149", "0152", "0153", "0154", "0155",
  "0156", "0157", "0158", "0159", "0160",
  "0172", "0173", "0174", "0175", "0176",
  "0177", "0178", "0179", "0180", "0181",
  "0185", "0194", "0195", "0196", "0197",
  "0198", "0199", "0202", "0208", "0214",
  "0215", "0225", "0228", "0229", "0242",
  "0243", "0244", "0245", "0246", "0247",
  "0248", "0252", "0253", "0254", "0255",
  "0256", "0257", "0258", "0259", "0260",
  "0280", "0281", "0282", "0287", "0288",
  "0289", "0302", "0303", "0304", "0305",
  "0306", "0311", "0312", "0316", "0317",
  "0333", "0334", "0353", "0354", "0359",
  "0360", "0363", "0364", "0365", "0403",
  "0404", "0405", "0425", "0426", "0430",
  "0438", "0439", "0440", "0447", "0448",
  "0453", "0454", "0459", "0460", "0461",
  "0462", "0468", "0470", "0471", "0475",
  "0488", "0491", "0517", "0518", "0627",
  "0628", "0700", "0702", "0736", "0737",
  "0738", "0759", "0760", "0764", "0778",
  "0845", "0848", "0849", "0906", "0907",
  "0908", "0909", "0910", "0911", "0912",
  "0913", "0914", "0921", "0922", "0923",
  "0980"
];

    let correctFlags = Array(pokemonTableRaw.length).fill(false);
    let solvedCount = 0;
    const totalCount = pokemonTableRaw.length;

    const progressText = document.getElementById("progressText");
    const list = document.getElementById("pokemonList");
    const inputElem = document.getElementById("pokemonInput");
    const answerBtn = document.getElementById("answerBtn");
    const startBtn = document.getElementById("startBtn");
    const timerElem = document.getElementById("timer");
    const shareBtnMain = document.getElementById("shareBtnMain");

    const overlay = document.getElementById("completeOverlay");
    const completeShareBtn = document.getElementById("completeShareBtn");
    const completeOk = document.getElementById("completeOk");

    // タイマー
    let startTime = null, timerId = null, running = false;
    function formatTime(ms){ const t=Math.floor(ms/1000); const h=String(Math.floor(t/3600)).padStart(2,'0'); const m=String(Math.floor((t%3600)/60)).padStart(2,'0'); const s=String(t%60).padStart(2,'0'); return h+':'+m+':'+s; }
    function startTimer(){ if(running) return; startTime=Date.now(); timerId=setInterval(()=>{ timerElem.textContent=formatTime(Date.now()-startTime); },200); running=true; inputElem.disabled=false; answerBtn.disabled=false; inputElem.focus(); }
    function stopTimer(){ if(!running) return; clearInterval(timerId); timerId=null; running=false; }

    function updateProgress(){ progressText.textContent = solvedCount + '／' + totalCount; }
    updateProgress();

    // 初期レンダー（空白）
    function renderList(){
      const frag = document.createDocumentFragment();
      for(let i=0;i<pokemonNumbers.length;i++){
        const div = document.createElement('div');
        div.className = 'cell';
        div.id = 'poke-' + i;
        div.textContent = pokemonNumbers[i] + '.　'; // 全角スペース
        frag.appendChild(div);
      }
      list.innerHTML = '';
      list.appendChild(frag);
    }
    renderList();

    function checkPokemon(){
      if(inputElem.disabled) return;
      const k = canon(inputElem.value);
      if(!k) return;

      const cells = list.querySelectorAll('.cell');
      for(let i=0;i<pokemonTableRaw.length;i++){
        if(!correctFlags[i] && k === canon(pokemonTableRaw[i])){
          correctFlags[i] = true;
          cells[i].textContent = pokemonNumbers[i] + '. ' + pokemonTableRaw[i];
          cells[i].scrollIntoView({ behavior:'smooth', block:'center' });
          solvedCount++; updateProgress();
          break;
        }
      }
      if(solvedCount === totalCount){ stopTimer(); overlay.style.display='flex'; }
      inputElem.value = ''; inputElem.focus();
    }

    inputElem.addEventListener('keydown', e => { if(e.key==='Enter' && !e.isComposing){ checkPokemon(); } });
    answerBtn.addEventListener('click', checkPokemon);
    startBtn.addEventListener('click', startTimer);

    shareBtnMain.addEventListener('click', () => {
      const text = '「ポケスリ全部いえるかな」ゲームに挑戦しました！' + totalCount + '匹中' + solvedCount + '覚えていたよ！経過時間は:' + timerElem.textContent + 'でした。 https://hitsujitani.github.io/ierukana_pokesuri/';
      const url = 'https://x.com/intent/tweet?text=' + encodeURIComponent(text);
      window.open(url, '_blank');
    });
    completeShareBtn.addEventListener('click', () => {
      const text = '「ポケスリ全部いえるかな」ゲームに挑戦しました！お見事！全問正解です！！達成時間は' + timerElem.textContent + 'でした。 https://hitsujitani.github.io/ierukana_pokesuri/';
      const url = 'https://x.com/intent/tweet?text=' + encodeURIComponent(text);
      window.open(url, '_blank');
    });
    completeOk.addEventListener('click', () => { overlay.style.display='none'; });
  </script>
</body>
</html>