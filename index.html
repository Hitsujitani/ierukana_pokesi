<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ポケスリ全部いえるかな？</title>
  <style>
    :root {
      --blue-light: #5aa9ff;
      --red-light: #ff7f7f;
      --text-white: #ffffff;
      --disabled-bg: #e0e0e0;
      --disabled-text: #9e9e9e;
    }
    body { font-family: Arial, sans-serif; padding: 20px; text-align: left; }
    h1 { text-align: center; }
    .input-row { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
    .hint { font-size: 0.9em; color: #444; }
    input { font-size: 16px; padding: 6px 8px; }
    button { font-size: 16px; padding: 8px 14px; cursor: pointer; border: none; border-radius: 6px; }
    .btn-answer { background: var(--blue-light); color: var(--text-white); }
    .btn-start { background: var(--red-light); color: var(--text-white); }
    .btn-share { background: var(--blue-light); color: var(--text-white); }
    button:disabled, input:disabled { background: var(--disabled-bg) !important; color: var(--disabled-text) !important; cursor: not-allowed; }
    #scrollContainer { max-height: 500px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin: 20px auto; width: 90%; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 10px; justify-content: center; }
    .grid div { font-weight: bold; }
    .footer { width: 90%; margin: 10px auto 0 auto; font-size: 12px; color: #555; text-align: right; line-height: 1.6; }
    .status-row { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; margin-top: 8px; }
    .status-left { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
    .status-right { margin-left: auto; }
    /* モーダル */
    .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 9999; }
    .modal { background: #fff; padding: 20px; border-radius: 8px; width: min(520px, 90vw); box-shadow: 0 6px 24px rgba(0,0,0,0.2); }
    .modal h2 { margin-top: 0; }
    .modal .actions { text-align: right; margin-top: 16px; display: flex; gap: 8px; justify-content: flex-end; }
    .modal button { font-size: 14px; padding: 6px 12px; }
    html, body {
  height: 100%;
}
body {
  margin: 0;
  /* 画像パスは配置場所に合わせて変更 */
  background-image: url("./greenglass.jpg");
  background-size: cover;       /* 画面いっぱいに拡大縮小 */
  background-position: center;  /* 中央寄せ */
  background-repeat: no-repeat; /* 繰り返しなし */
  /* 必要なら固定表示 → モバイルでの描画が重い場合は外してください */
  /* background-attachment: fixed; */
  background-color: #8fdc6b;    /* 読み込み前の下地色（任意） */
}
  </style>
</head>
<body>
  <h1>ポケスリ全部いえるかな？</h1>

  <div class="input-row">
    <p class="hint">ポケモンの名前を入力してください（ひらがなOK）</p>
    <strong id="progressText">0／0</strong>
  </div>

  <div class="status-row">
    <div class="status-left">
      <input type="text" id="pokemonInput" placeholder="ポケモンの名前を入力" disabled />
      <button id="answerBtn" class="btn-answer" disabled>回答</button>
      <button id="startBtn" class="btn-start">開始</button>
      <span id="timer">00:00:00</span>
    </div>
    <div class="status-right">
      <button id="shareBtnMain" class="btn-share">結果をXで共有</button>
    </div>
  </div>

  <div id="scrollContainer">
    <div class="grid" id="pokemonList">
      <div id="poke-0">0001. ???</div><div id="poke-1">0002. ???</div><div id="poke-2">0003. ???</div><div id="poke-3">0004. ???</div><div id="poke-4">0005. ???</div><div id="poke-5">0006. ???</div><div id="poke-6">0007. ???</div><div id="poke-7">0008. ???</div><div id="poke-8">0009. ???</div><div id="poke-9">0010. ???</div><div id="poke-10">0011. ???</div><div id="poke-11">0012. ???</div>
    </div>
  </div>

  <div class="footer">
    <div> Ver. 2.12.2 </div>
    <div> X：羊谷ランプ@fuck_capslock（<a href="https://x.com/fuck_capslock" target="_blank" rel="noopener noreferrer">https://x.com/fuck_capslock</a>）</div>
    <div> Inspired by ポケモン全部言えるかな？ゲーム </div>
  </div>

  <!-- 全問正解ポップアップ（モーダル） -->
  <div id="completeOverlay" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="completeTitle">
    <div class="modal">
      <h2 id="completeTitle">全問正解！あなたは立派な廃人プレイヤーです！！</h2>
      <div class="actions">
        <button id="completeShareBtn" class="btn-share">結果をXで共有</button>
        <button id="completeOk" class="btn-start">OK</button>
      </div>
    </div>
  </div>

  <script>
    const pokemonTableRaw = [
  "フシギダネ","フシギソウ","フシギバナ",
  "ヒトカゲ","リザード","リザードン",
  "ゼニガメ","カメール","カメックス",
  "キャタピー","トランセル","バタフリー",
  "コラッタ","ラッタ","アーボ","アーボック",
  "ピカチュウ","ピカチュウ(ハロウィン)","ピカチュウ(ホリデー)",
  "ライチュウ","ピッピ","ピクシー","ロコン","ロコン(アローラ)",
  "キュウコン","キュウコン(アローラ)","プリン","プクリン",
  "ディグダ","ダグトリオ","ニャース","ペルシアン","コダック",
  "ゴルダック","マンキー","オコリザル","ガーディ","ウインディ",
  "マダツボミ","ウツドン","ウツボット","イシツブテ","ゴローン",
  "ゴローニャ","ヤドン","ヤドラン","コイル","レアコイル","カモネギ",
  "ドードー","ドードリオ","ゴース","ゴースト","ゲンガー","イワーク",
  "カラカラ","ガラガラ","ラッキー","ガルーラ","バリヤード","カイロス",
  "メタモン","イーブイ","イーブイ(ホリデー)","シャワーズ","サンダース",
  "ブースター","ミニリュウ","ハクリュー","カイリュー","チコリータ",
  "ベイリーフ","メガニウム","ヒノアラシ","マグマラシ","バクフーン",
  "ワニノコ","アリゲイツ","オーダイル","ピチュー","ピィ","ププリン",
  "トゲピー","トゲチック","ネイティ","ネイティオ","メリープ","モココ",
  "デンリュウ","ウソッキー","ウパー","ウパー(パルデア)","ヌオー","エーフィ",
  "ブラッキー","ヤミカラス","ヤドキング","ソーナンス","ハガネール","ヘラクロス",
  "ニューラ","デリバード","デルビル","ヘルガー","ハピナス","ライコウ","エンテイ",
  "スイクン","ヨーギラス","サナギラス","バンギラス","キモリ","ジュプトル",
  "ジュカイン","アチャモ","ワカシャモ","バシャーモ","ミズゴロウ","ヌマクロー",
  "ラグラージ","ラルトス","キルリア","サーナイト","ナマケロ","ヤルキモノ",
  "ケッキング","ヤミラミ","クチート","ココドラ","コドラ","ボスゴドラ","プラスル",
  "マイナン","ゴクリン","マルノーム","チルット","チルタリス","カゲボウズ","ジュペッタ",
  "アブソル","ソーナノ","タマザラシ","トドグラー","トドゼルガ","コリンク","ルクシオ",
  "レントラー","フワンテ","フワライド","ドンカラス","ウソハチ","マネネ","ピンプク",
  "リオル","ルカリオ","グレッグル","ドクロッグ","ユキカブリ","ユキノオー","マニューラ",
  "ジバコイル","トゲキッス","リーフィア","グレイシア","エルレイド","クレセリア",
  "ダークライ","ムンナ","ムシャーナ","ワシボン","ウォーグル","ニンフィア","デデンネ",
  "アゴジムシ","デンヂムシ","クワガノン","ヌイコグマ","キテルグマ","キュワワー","ミミッキュ",
  "ウッウ","エレズン","ストリンダー(ハイ)","ストリンダー(ロー)","ニャオハ","ニャローテ",
  "マスカーニャ","ホゲータ","アチゲータ","ラウドボーン","クワッス","ウェルカモ",
  "ウェーニバル","パモ","パモット","パーモット","ドオー"
];

const pokemonNumbers = [
  "0001","0002","0003","0004","0005","0006","0007","0008","0009",
  "0010","0011","0012","0019","0020","0023","0024","0025","0025",
  "0025","0026","0035","0036","0037","0037","0038","0038","0039",
  "0040","0050","0051","0052","0053","0054","0055","0056","0057",
  "0058","0059","0069","0070","0071","0074","0075","0076","0079",
  "0080","0081","0082","0083","0084","0085","0092","0093","0094",
  "0095","0104","0105","0113","0115","0122","0127","0132","0133",
  "0133","0134","0135","0136","0147","0148","0149","0152","0153",
  "0154","0155","0156","0157","0158","0159","0160","0172","0173",
  "0174","0175","0176","0177","0178","0179","0180","0181","0185",
  "0194","0194","0195","0196","0197","0198","0199","0202","0208",
  "0214","0215","0225","0228","0229","0242","0243","0244","0245",
  "0246","0247","0248","0252","0253","0254","0255","0256","0257",
  "0258","0259","0260","0280","0281","0282","0287","0288","0289",
  "0302","0303","0304","0305","0306","0311","0312","0316","0317",
  "0333","0334","0353","0354","0359","0360","0363","0364","0365",
  "0403","0404","0405","0425","0426","0430","0438","0439","0440",
  "0447","0448","0453","0454","0459","0460","0461","0462","0468",
  "0470","0471","0475","0488","0491","0517","0518","0627","0628",
  "0700","0702","0736","0737","0738","0759","0760","0764","0778",
  "0845","0848","0849","0849","0906","0907","0908","0909","0910",
  "0911","0912","0913","0914","0921","0922","0923","0980"
];
let correctFlags = Array(pokemonTableRaw.length).fill(false);
    let solvedCount = 0;
    const totalCount = pokemonTableRaw.length;

    const progressText = document.getElementById("progressText");
    const inputElem = document.getElementById("pokemonInput");
    const answerBtn = document.getElementById("answerBtn");
    const startBtn = document.getElementById("startBtn");
    const timerElem = document.getElementById("timer");
    const shareBtnMain = document.getElementById("shareBtnMain");

    // モーダル
    const overlay = document.getElementById("completeOverlay");
    const completeShareBtn = document.getElementById("completeShareBtn");
    const completeOk = document.getElementById("completeOk");

    // タイマー
    let startTime = null;
    let timerId = null;
    let running = false;

    function formatTime(ms) {
      const totalSec = Math.floor(ms / 1000);
      const h = String(Math.floor(totalSec / 3600)).padStart(2, '0');
      const m = String(Math.floor((totalSec % 3600) / 60)).padStart(2, '0');
      const s = String(totalSec % 60).padStart(2, '0');
      return `${h}:${m}:${s}`;
    }

    function startTimer() {
      if (running) return;
      startTime = Date.now();
      timerId = setInterval(() => {
        const elapsed = Date.now() - startTime;
        timerElem.textContent = formatTime(elapsed);
      }, 200);
      running = true;
      // 入力と回答を有効化
      inputElem.disabled = false;
      answerBtn.disabled = false;
      inputElem.focus();
    }

    function stopTimer() {
      if (!running) return;
      clearInterval(timerId);
      timerId = null;
      running = false;
    }

    // 進捗表示更新
    function updateProgress() {
      progressText.textContent = solvedCount + "／" + totalCount;
    }
    updateProgress();

    // ひらがな→カタカナ
    function toKatakana(str) {
      return str.replace(/[ぁ-ゖ]/g, ch => String.fromCharCode(ch.charCodeAt(0) + 0x60));
    }

    function checkPokemon() {
      if (inputElem.disabled) return; // 念のため
      const input = inputElem.value.trim();
      if (input === "") return;

      const katakanaInput = toKatakana(input);
      const listItems = document.querySelectorAll("#pokemonList div");

      for (let i = 0; i < pokemonTableRaw.length; i++) {
        const katakanaAnswer = toKatakana(pokemonTableRaw[i]);
        if (!correctFlags[i] && katakanaInput === katakanaAnswer) {
          correctFlags[i] = true;
          listItems[i].textContent = pokemonNumbers[i] + ". " + pokemonTableRaw[i];
          listItems[i].scrollIntoView({ behavior: "smooth", block: "center" });
          solvedCount++;
          updateProgress();
          break;
        }
      }

      if (solvedCount === totalCount) {
        stopTimer();
        // 完了ポップアップを表示
        overlay.style.display = "flex";
      }

      inputElem.value = "";
      inputElem.focus();
    }

    // Enter確定時のみ回答（IME中は発火しない）
    inputElem.addEventListener("keydown", e => {
      if (e.key === "Enter" && !e.isComposing) {
        checkPokemon();
      }
    });

    // ボタン
    answerBtn.addEventListener("click", checkPokemon);
    startBtn.addEventListener("click", startTimer);

    // 画面の右端の共有ボタン（挑戦状況）
    shareBtnMain.addEventListener("click", () => {
      const text = `「ポケスリ全部いえるかな」ゲームに挑戦しました！${totalCount}匹中${solvedCount}覚えていたよ！経過時間は:${timerElem.textContent}でした。 https://hitsujitani.github.io/ierukana_pokesuri/`;
      const url = "https://x.com/intent/tweet?text=" + encodeURIComponent(text);
      window.open(url, "_blank");
    });

    // 完了ポップアップの共有ボタン
    completeShareBtn.addEventListener("click", () => {
      const text = `「ポケスリ全部いえるかな」ゲームに挑戦しました！お見事！全問正解です！！達成時間は${timerElem.textContent}でした。 https://hitsujitani.github.io/ierukana_pokesuri/`;
      const url = "https://x.com/intent/tweet?text=" + encodeURIComponent(text);
      window.open(url, "_blank");
    });

    // モーダル OK で閉じる
    completeOk.addEventListener("click", () => {
      overlay.style.display = "none";
    });
  </script>
</body>
</html>
